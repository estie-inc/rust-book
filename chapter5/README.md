紙面だけでは追いかけるのが難しい部分もあるので、一旦各セクション末時点のコードを載せてます